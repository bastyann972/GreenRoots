<%- include('partials/header') %>
    <main class="main-container">
        <div class="profile-container">
            <div class="profile-header">
                <h1>Mon Profil</h1>
                <p>Gérez vos informations personnelles et vos préférences</p>
            </div>

            <div class="profile-card">
                <div class="profile-avatar">
                    <div class="avatar-circle">
                        <!-- Affiche les initiales dynamiquement -->
                        <p>
                            <%= user.firstname[0] %>
                                <span>
                                    <%=user.lastname[0] %>
                                </span>
                        </p>
                    </div>
                </div>

                <form class="profile-form" action="/profil/edit" method="POST">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Prénom</label>
                            <div class="input-icon">
                                <input type="text" name="firstName" value="<%= user.firstname %>" required>
                                <i class="fas fa-user"></i>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Nom</label>
                            <div class="input-icon">
                                <input type="text" name="lastName" value="<%= user.lastname %>" required>
                                <i class="fas fa-user"></i>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Email</label>
                            <div class="input-icon">
                                <input type="email" name="email" value="<%= user.email %>" required>
                                <i class="fas fa-envelope"></i>
                            </div>
                        </div>
                    </div>

                    <button type="submit" class="btn-save">
                        Sauvegarder les modifications
                    </button>
                </form>

                <div class="password-section">
                    <h2>Modification du mot de passe</h2>
                    <form id="password-form" action="/profil/password" method="POST" class="password-form hidden">
                        <div class="password-input">
                            <label for="currentPassword">Mot de passe actuel</label>
                            <input type="currentPassword" id="password" name="currentPassword" class="form-input"
                                placeholder="Votre mot de passe" required minlength="12"
                                title="Le mot de passe doit contenir au moins 12 caractères, une minuscule, une majuscule, un chiffre et un caractère spécial." />
                            <button type="button" id="togglePassword" class="toggle-password">
                                <svg id="eyeOpen" class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                    <circle cx="12" cy="12" r="3" />
                                </svg>
                                <svg id="eyeClosed" class="eye-icon hidden" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2">
                                    <path d="M17.94 17.94a10.54 10.54 0 0 1-11.88 0" />
                                    <path d="M1 12s4-8 11-8c2.92 0 5.58 1.06 7.78 2.82M15 15a3 3 0 1 1-4-4" />
                                    <line x1="1" y1="1" x2="23" y2="23" />
                                </svg>
                            </button>
                        </div>
                        <div class="password-input">
                            <label for="newPassword">Nouveau mot de passe</label>
                            <input type="newPassword" id="password" name="newPassword" class="form-input"
                                placeholder="Votre mot de passe" required minlength="12"
                                title="Le mot de passe doit contenir au moins 12 caractères, une minuscule, une majuscule, un chiffre et un caractère spécial." />
                            <button type="button" id="togglePassword" class="toggle-password">
                                <svg id="eyeOpen" class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                    <circle cx="12" cy="12" r="3" />
                                </svg>
                                <svg id="eyeClosed" class="eye-icon hidden" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2">
                                    <path d="M17.94 17.94a10.54 10.54 0 0 1-11.88 0" />
                                    <path d="M1 12s4-8 11-8c2.92 0 5.58 1.06 7.78 2.82M15 15a3 3 0 1 1-4-4" />
                                    <line x1="1" y1="1" x2="23" y2="23" />
                                </svg>
                            </button>
                        </div>

                        <div class="password-input">
                            <label for="newPasswordConfirm">Confirmation du mot de passe</label>
                            <input type="newPasswordConfirm" id="passwordConfirm" name="newPasswordConfirm"
                                class="form-input" placeholder="Votre mot de passe" required minlength="12"
                                title="Le mot de passe doit contenir au moins 12 caractères, une minuscule, une majuscule, un chiffre et un caractère spécial." />
                            <button type="button" id="togglePassword" class="toggle-password">
                                <svg id="eyeOpen" class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                    <circle cx="12" cy="12" r="3" />
                                </svg>
                                <svg id="eyeClosed" class="eye-icon hidden" viewBox="0 0 24 24" fill="none"
                                    stroke="currentColor" stroke-width="2">
                                    <path d="M17.94 17.94a10.54 10.54 0 0 1-11.88 0" />
                                    <path d="M1 12s4-8 11-8c2.92 0 5.58 1.06 7.78 2.82M15 15a3 3 0 1 1-4-4" />
                                    <line x1="1" y1="1" x2="23" y2="23" />
                                </svg>
                            </button>
                        </div>


                        <div class="password-form-buttons">
                            <button type="button" class="btn-cancel" id="cancel-password">
                                Annuler
                            </button>
                            <button type="submit" class="btn-save">
                                Mettre à jour
                            </button>
                        </div>
                    </form>

                    <button id="show-password-form" class="btn-password">
                        <i class="fas fa-lock"></i>
                        Changer le mot de passe
                    </button>
                </div>

                <!-- Ajouter le bouton de suppression -->
                <div class="delete-account-section">
                    <h2>Suppression du compte</h2>
                    <form action="/profil/delete" method="POST"
                        onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer votre compte ? Cette action est irréversible.')">
                        <button type="submit" class="btn-delete">
                            Supprimer mon compte
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </main>
    <%- include('partials/footer') %>